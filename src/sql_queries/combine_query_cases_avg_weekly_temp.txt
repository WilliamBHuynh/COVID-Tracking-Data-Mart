SELECT h.city AS "City", r.week_in_year AS "Week", ROUND(AVG(w.daily_mean),2) AS "Avg. Weekly Temp", COUNT(f.resolved) AS "Cases"
FROM d_weather w, fact_table f, d_reported_date r, d_phu h
WHERE h.city = 'Ottawa' AND w.weather_key = f.weather_key AND h.phu_surrogate_key = f.phu_key AND r.reported_date_surrogate_key = f.reported_date_key
GROUP BY r.year, r.week_in_year, h.city
ORDER BY r.year, r.week_in_year